<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="HyperNeRF handles topological variations by modeling a family of shapes in a higher-dimensional space, thereby producing more realistic renderings and more accurate geometric reconstructions.">
  <meta name="keywords" content="HyperNeRF, Nerfies, D-NeRF, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="./static/images/thumbnail.png"/>
  <link rel="image_src" href="./static/images/thumbnail.png">
  <link rel="icon"
        type="image/x-icon"
        href="./static/images/favicon.ico"/>

  <title>Symbolic Visual Reinforcement Learning: \\ A Scalable Framework with Object-Level Abstraction and Differentiable Expression Search</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<!--   <script async src="https://www.googletagmanager.com/gtag/js?id=G-EDF010G6PN"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EDF010G6PN');


  </script> -->
<!-- 
  <script type="module"
          src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script src="https://unpkg.com/interactjs/dist/interact.min.js"></script>
 -->
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" type="text/css" href="./static/slick/slick.css"/>
  <link rel="stylesheet" type="text/css" href="./static/slick/slick-theme.css"/>

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

</head>


<body>
<!-- 
<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div>
    </div>

  </div>
</nav>
 -->


<style>
@font-face {
  font-family: 'Symbola';
  src: url('fonts/symbola.otf') format('opentype');
}
</style>



<section class="hero">
  <div class="hero-body">
    <div class="container">
      <!-- <div class="columns is-centered">
        <div class="column is-4 has-text-centered">
          <img src="static/images/logo.svg" alt="HyperNeRF"/>
        </div>
      </div> -->
      <div class="container has-text-centered">
        <h1 class="title is-1 publication-title">
          Symbolic Visual Reinforcement Learning: <br/> A Scalable Framework with Object-Level Abstraction <br/> and Differentiable Expression Search
        </h1>
        <div class="is-size-5 publication-authors">

          <div class="author-block">
            <!-- <div class="author-portrait"> -->
              <!-- <img src="./static/images/portraits/keunhong_rgb.128.gif" class="rgb preload" /> -->
              <!-- <img src="./static/images/portraits/keunhong_depth.128.gif" class="depth preload" /> -->
            <!-- </div> -->
            <a href="http://wenqing-zheng.github.io">Wenqing Zheng </a><sup>*</sup></div>,

          <div class="author-block">
            <!-- <div class="author-portrait"> -->
              <!-- <img src="./static/images/portraits/utsinh_rgb.128.gif" class="rgb preload" /> -->
              <!-- <img src="./static/images/portraits/utsinh_depth.128.gif" class="depth preload" /> -->
            <!-- </div> -->
            <a href="https://github.com/Syzygianinfern0">S P Sharan</a><sup>*</sup></div>,
          
          <div class="author-block">
            <!-- <div class="author-portrait"> -->
              <!-- <img src="./static/images/portraits/hedman_rgb.128.gif" class="rgb preload" /> -->
              <!-- <img src="./static/images/portraits/hedman_depth.128.gif" class="depth preload" /> -->
            <!-- </div> -->
            <a href="https://zhiwenfan.github.io">Zhiwen Fan </a>,
          </div>
          
          <div class="author-block">
            <div class="author-portrait">
              <img src="./static/images/portraits/barron_rgb.128.gif" class="rgb preload" />
              <img src="./static/images/portraits/barron_depth.128.gif" class="depth preload" />
            </div>
            <!-- <a href="https://jonbarron.info">Kevin Wang</a><sup>2</sup> -->
            <!-- Kevin Wang -->
            <a >Kevin Wang</a>,
          </div>
          
          <div class="author-block">
            <!-- <div class="author-portrait"> -->
              <!-- <img src="./static/images/portraits/sofien_rgb.128.gif" class="rgb preload" /> -->
              <!-- <img src="./static/images/portraits/sofien_depth.128.gif" class="depth preload" /> -->
            <!-- </div> -->
            <a >Yihan Xi </a>,
          </div>
          
          <div class="author-block">
            <!-- <div class="author-portrait"> -->
              <!-- <img src="./static/images/portraits/dgo_rgb.128.gif" class="rgb preload" /> -->
              <!-- <img src="./static/images/portraits/dgo_depth.128.gif" class="depth preload" /> -->
            <!-- </div> -->
            <a href="https://www.ece.utexas.edu/people/faculty/atlas-wang"> Atlas Wang </a>
          </div>
          
        </div>

        <div class="is-size-5 publication-authors">
          <span class="author-block">The University of Texas At Austin</span><br/>
          <span class="author-block"><sup>*</sup>Equal Contribution</span>
        </div>

        <div class="column has-text-centered">
          <div class="publication-links">
            <!-- PDF Link. -->
            <span class="link-block">
                <a href="https://arxiv.org/pdf/pending-symrel-arxiv-paper"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
            <span class="link-block">
                <a href="https://arxiv.org/abs/pending-symrel-arxiv-paper"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
            </span>
            <span class="link-block">
              <a href="https://github.com/pending-symrel-code"
                 class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                    <i class="fab fa-github"></i>
                </span>
                <span>Code</span>
                </a>
            </span>
            <!-- Dataset Link. -->
<!--             <span class="link-block">
              <a href="https://github.com/google/hypernerf/releases/tag/v0.1"
                 class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                    <i class="far fa-images"></i>
                </span>
                <span>Data</span>
                </a>
              </span> -->
          </div>
        </div>
      </div>
    </div>
  </div>
</section>




  <!-- <div class="columns is-centered has-text-centered"> -->
  <div class="container is-max-desktop">
    <center>
    <h2 class="title is-3">Overview</h2>
            <br>
    </center>
    <div class="content has-text-justified">
      <p>
        This paper presents <b>DiffSES</b>, a framework that learns and generates symbolic policies for a visual environment. An example of symbolic policy generated for the <i>Pong-Atari2600</i> environment is shown below:
      </p>

      <div class="has-text-centered">
        <img style="width: 90%;" src="./static/figures/symbolic-policy-pong.pdf"
             alt="Demo symbolic tree"/>      
      </div>

      <p>
         The generated symbolic policy takes the form of a forest of N<sub>action</sub> symbolic trees (above is one such tree, the other trees take similar structures), each tree corresponds to one action, whose execution value represents the probability for this action (pre-normalization), same as the neural networks based agents.
      </p>
      <p>
        The DiffSES is developed from object level abstraction of the scene, rather than raw pixel level, or higher level of text planning as previous works did. It uses an unsupervised object detection module to discover objects in the current frame, and learn/search symbolic expressions to discover meaningful objects and features. 
      </p>
      <p>
        In this way, the inputs to the learned symbolic expression are object features. The leaf nodes X<sub>0</sub>, X<sub>1</sub>, ... are the relabeled objects' positions and velocities. Such symbolic expressions offer potential explanability of the controlling policy: some subtrees might happen to constitute geometrically interpretable meanings.
        For example, the geometric features (leaf nodes) X<sub>0</sub>, X<sub>1</sub>, ... could be  x<sub>pong</sub>, x<sub>racket</sub>, y<sub>pong</sub>, v<sub>y,pong</sub>, the x/y location of the pong and the racket, and vertical velocity of the pong. Then one subtree might appear as: y<sub>pong</sub> + v<sub>y, pong</sub> * (x<sub>racket</sub> - x<sub>pong</sub>)*c. This could mean the y axis of the aiming point of the pong on the racket, where c is some constant to convert the horizontal distance into time gap. The aiming point is where the racket should ultimately go to. If such sub-expressions are found, it could hint that similar logic is learned.
      </p>
      <p>
        The inference procedure of the learned symbolic policy is shown in the figure below.
      </p>


      <div class="has-text-centered">
        <img style="width: 60%;" src="./static/figures/flow-1.png"
             alt="Demo symbolic tree"/>      
      </div>
      <br>


  </div>
</section>


<section class="hero teaser">
  <div class="container is-max-desktop">
    <center>
    <h2 class="title is-3">Symbolic Agent Behavior Illustrations</h2>
    </center>
  </div>
            <br>
            <br>

    <center>
      
      We mainly compared in these environments.
            <br>
            <br>

      <div class="has-text-centered">
        <img style="width: 80%;" src="./static/figures/teaser-1.png"
             alt="Demo symbolic tree"/>      
      </div>
            <br>
      Some observations are shown the videos below.
            <br>
            <br>
    </center>




  <div class="hero-body">
    <div class="container is-max-desktop">
      <video id="teaser" autoplay controls muted loop playsinline height="100%">
        <source src="./static/videos/video-2-compressed.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        This video illustrates the behaviors of the <i>neural network agent</i>, which is based on CNN and trained via PPO, and the learned <i>symbolic policy</i>, which is initialized by the PPO agent. The video displays three example environments, and the action distribution is diplayed at the bottom. 
      </h2>
    </div>
  </div>
</section>




<section class="hero is-dark">
  <div class="hero-body">
    <div class="container has-text-centered">
      <div id="results-carousel" class="carousel results-carousel">

        <!-- <div> -->
          <div class="results-item">


            <video poster="" id="split-cookie-rgb" autoplay controls muted loop playsinline height="800px" width="600px">
              <source src="./static/videos/video-3-compressed.mp4"
                      type="video/mp4">
            </video>
            <!-- <video poster="" id="split-cookie-depth" autoplay controls muted loop playsinline height="100%"> -->
              <!-- <source src="./static/videos/split-cookie_depth.mp4" -->
                      <!-- type="video/mp4"> -->
            <!-- </video> -->
          </div>
        <!-- </div> -->

      </div>

      <div class="columns is-centered has-text-centered">
        <div class="column is-three-quarters">
          <p>
            Here is the comparison of the models in a transfer learning setting. In this setting, the teacher DRL model is trained in AdventureIsland3, and the symbolic agent is learned based on it. Then both agents are applied to AdventureIsland2 without fine-tuning. The performance of the symbolic policy drops less than DRL model.
          </p>
        </div>
      </div>

    </div>
  </div>
</section>




<!-- 
<section class="hero vid3">
  <div class="hero-body">
    <div class="container is-max-desktop">
        <h2 class="title is-3">Abstract</h2>
      111111  2222222

      <h2 class="subtitle has-text-centered">
        <i>desc3333</i>
      </h2>
    </div>
  </div>
</section>
 -->





<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
Learning efficient and interpretable policies has been a challenging task in reinforcement learning (RL), particularly in the visual RL setting with complex scenes. While deep neural networks have achieved competitive performance, the resulting policies are often over-parameterized black boxes that are difficult to interpret and deploy efficiently. More recent symbolic RL frameworks have shown that high-level domain-specific programming logic can be designed to handle both policy learning and symbolic planning. However, these approaches often rely on human-coded primitives with little feature learning, and when applied to high-dimensional continuous conversations such as visual scenes, they can suffer from scalability issues and perform poorly when images have complicated compositions and object interactions.
          </p>
          <p>
To address these challenges, we propose <i>Differentiable Symbolic Expression Search</i> (DiffSES), a novel symbolic learning approach that discovers discrete symbolic policies using partially differentiable optimization. By using object-level abstractions instead of raw pixel-level inputs, DiffSES is able to leverage the simplicity and scalability advantages of symbolic expressions, while also incorporating the strengths of neural networks for feature learning and optimization.
Our experiments demonstrate that DiffSES is able to generate symbolic policies that are more interpretable and scalable than state-of-the-art symbolic RL methods, even with a reduced amount of symbolic prior knowledge.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

  </div>
</section>

<hr/>


<!-- 
!!!!!!!!!!!!!!!!

tree demo

grid
  Motivation
    improve symbolic based visual RL
  Method: learn, distillation, fine tune

video1: distribution
video2: transfer

Abstract

Results
  Comparison: (table)
  imperfect OD




-->


<section class="section">
  <div class="container is-max-desktop">
    <center>
      <h2 class="title is-3">Method</h2>
                  <br>
                  <br>
    </center>
    <div class="columns is-centered">
      <!-- Level Sets. -->
      <div class="column is-half">
        <div class="content">
          <h3 class="title is-4">Motivations</h3>
          <div class="level-set has-text-justified">
            <p>
              Symbolic expressions demonstrate simplicity and effectiveness compared with over-parameterized DRL model. Previous works on symbolic RL either fail to scale to complex visual scenes, or use pixel level inputs to directly evolve symbolic expressions, which are often over-complex and require carefully curated operator set. 
            </p>
            <p>
              We assume that object level abstraction could generate simpler policies than pixel level methods. To discover object information in new scenes with minimum human interference, we adopt an unsupervised object detection module.
            </p>
            <p>
              Furthermode, to make the symbolic expression search procedure more flexible, we introduce differentiable search in the vanilla genetic programming with neural network guidance.
            </p>

          </div>
        </div>
      </div>
      <!--/ Level Sets. -->

      <div class="column is-half">
        <div class="content has-text-justified">
          <h3 class="is-4">Learning steps</h3>
          <p>
            The symbolic policy consists of the unsupervised object detection module and the 
            We employ symbolic knowledge distillation followed by fine-tuning. The pipline consists of three steps.
          <p>
            <b>Step I</b>: A traditional CNN based DRL agent in trained using PPO.
          <p>
            <b>Step II</b>: The DRL model is distilled into symbolic expressions using genetic programming based symbolic regression. 
          <p>
            <b>Step III</b>: The symbolic expressions are fine-tuned with the proposed neural guided search which integrates gradient descent into genetic programming mutation procedure for symbolic expressions.
          </p>

        </div>
      </div>

    </div>
  </div>



<hr/>








<section class="hero is-dark">
  <div class="hero-body">
    <div class="container has-text-centered">
      <div id="results-carousel" class="carousel results-carousel">

    <center>
    <h2 class="title is-3">Compatible Environments</h2>

      <div class="has-text-centered">
        <img style="width: 100%;" src="./static/figures/doables.png"
             alt="Demo symbolic tree"/>      
      </div>
    </center>

      </div>

      <div class="columns is-centered has-text-centered">
        <div class="column is-three-quarters">
          <p>
            Here is a subset of environments we found the proposed DiffSES is compatible with. To effectively control in these environments, it require handling geometric relationships beween objects and the protagonist. These relationships can usually be expressed as straight lines intersections, which is what symbolic expressions are good at.
          </p>
        </div>
      </div>

    </div>
  </div>
</section>







<section class="section" id="BibTeX">
  <div class="container content is-max-desktop">
        <center>
    <h2 class="title">BibTeX</h2>
      </center>
    <pre><code>
   <!--    @article{park2021hypernerf,
  author = {pending !!!!!!!!!},
  title = {pending title},
  journal = {ACM Trans. Graph.},
  issue_date = {December 2021},
  publisher = {ACM},
  volume = {40},
  number = {6},
  month = {dec},
  year = {2021},
  articleno = {238},
  } -->
  Comming soon.
</code></pre>
  </div>
</section>

<!-- 
<section class="section" id="acknowledgements">
  <div class="container content is-max-desktop">
    <h2 class="title">Acknowledgements</h2>
    <p>Special thanks to <a href="https://homes.cs.washington.edu/~holynski/">Aleksander Hołyński</a>,
      <a href="https://roxanneluo.github.io/">Xuan Luo</a>, and Haley Cho for their support and
      help with collecting data. Thanks to <a href="https://zhengqili.github.io/">Zhengqi Li</a> and
      <a href="http://www.oliverwang.info/">Oliver Wang</a> for their help with the NSFF experiments.</p>
  </div>
</section> -->
<!-- 

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link" href="https://arxiv.org/pdf/2106.13228.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
  </div>
</footer> -->

<script type="text/javascript" src="./static/slick/slick.min.js"></script>
</body>
</html>

